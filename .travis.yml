os: osx
sudo: required
language: node_js
node_js:
  - "6"

#blocklist
branches:
  except:
    - gh-pages

cache:
  directories:
  - node_modules

# Environment setup
before_install:
  # Download and unzip Sketch.
  - wget https://www.sketchapp.com/download/sketch.zip
  - unzip sketch.zip
  # Install SketchTool
  - Sketch.app/Contents/Resources/sketchtool/install.sh
  # Install FontForge
  - brew install ttfautohint fontforge --with-python

# Build
script:
  - grunt

# Deploy
deploy:
  - provider: releases
    api_key:
      secure: hIno1w4NhUqpkvKlmuwVosUmn8JS19/ScHe3a04gH751j956Odw+TT/1PEKuC/XRP4HL6Uf+PDapYEoZd/YuRFtA6JmNbgV51IJmqJ8rcm2upecxglpePU/+yyokXHeitHckVahwHw0sc+/UITEsEpmudgCe8qQZjL3ZhN3ddG++MLMAeUm3wJmc1yn8ncfGWDsdJTCz1ZMustJJE/kgMa2npPffYMAPU8R67V9iQNEVp6Z4Dh/NOlYeWawxbFmNhIxMgQyeGvxPW8RlO7vJZ+JuXUqop34lAMXfKdxmdr9HPZR2+j4lcsLXWLlau7WC+EwsFH3iXbSr9Z8ne3wmRBysA7D/7sfvI0FRKXb8OqFGkyZ0KCpl1KFGtnI7gj4NKrRUiB7NQzvusJiII8YJZII2gq3HdQ2wVpWpwkGFf7EIVxHncDY6/MSMvCs4ybwOTClzc8plHYrhVJuJd4pM+9+H1KVQcvDzNBu5BybUFDlKTZypOONk9sie7fVg2cDz1aCgOHpYCbHte4hbscsKrOzUNp6GPM8Ce778E8vaXDbTk/W09lZ29xvGC07Mrxbb81/1oSNy7jX7sgCRNfhAVJTVmms7Tn8QG4x8FLmV5bNuvrFUWWJcNcsH5GFg2ktws6IUoMooHbdzgjPoSUOEyppw4j5U3uhR5xv4L+dGOMc=
    skip_cleanup: true
    overwrite: true
    on:
      repo: jacoblapworth/TradeMe.TradeMe.IconFont
      tags: true
    file:
      - dist/tmicons-production.zip
      - dist/tmicons-sketch.zip
  - provider: pages
    github_token:
      secure: $GITHUB_TOKEN
    skip_cleanup: true
    overwrite: true
    on:
      tags: true
    local_dir: docs/
